# 놀이 세션 분석 시스템 (Care Intelligence)

선생님과 아동의 놀이 활동을 분석하여 발달 지표를 추출하고, **타겟별 맞춤형 레포트**를 자동 생성하는 시스템입니다.

## ✨ 핵심 기능

### 🎯 자동 생성되는 4가지 문서

| 문서 | 대상 | 특징 | 용도 |
|------|------|------|------|
| **부모용 레포트** | 학부모 | 긍정적, 이해하기 쉬움 | 가정 연계, 발달 공유 |
| **선생님용 레포트** | 교사 | 교육적 인사이트 | 수업 개선, 교육 전략 |
| **방문일지** | 공식 기록 | 누리과정 5개 영역 | 법적 기록, 서명 문서 |
| **회사용 레포트** | 내부 관리 | 상세 데이터 분석 | 품질 관리, 서비스 개선 |

### 📊 분석 지표 (8개)

1. **아동발화비율** - 전체 대화에서 아동의 참여도
2. **발화양** - 발화 횟수, 단어 수, 평균 문장 길이
3. **주제지속도** - 한 주제에 몰입하는 정도 (집중력)
4. **맥락전환도** - 주제 전환 빈도 (탐색성)
5. **문제해결발화** - '왜?', '어떻게?' 질문 횟수 (인지 발달)
6. **긍정/부정비율** - 정서 표현 분석 (정서 안정성)
7. **주요정서단어** - 자주 사용하는 감정 표현
8. **주요토픽** - 관심 주제 및 키워드 TOP 20

---

## 🚀 빠른 시작

### 1. 환경 설정

```bash
# Python 3.7+ 필요
pip install numpy

# 또는 requirements.txt 사용
pip install -r requirements.txt
```

### 2. 단일 세션 분석 (기본)

```bash
# 기본 테스트 실행
python3 run_full_analysis.py

# 특정 세션 분석
python3 run_full_analysis.py --session raw_data/[세션폴더]
```

**예시:**
```bash
python3 run_full_analysis.py \
  --session raw_data/20251017-이민정교사-김준우-만4세-02_00_48-65kbps_mono
```

### 3. 일괄 처리 (여러 세션)

```bash
# raw_data의 모든 세션 처리
python3 run_full_analysis.py --batch

# 처음 2개만 처리 (테스트용)
python3 run_full_analysis.py --batch --limit 2
```

---

## 📁 데이터 구조

### 입력

```
raw_data/
└── [세션명]/
    ├── vtt/                    # 대화 텍스트 (필수)
    │   ├── [세션명]_000-002분_subtitle.vtt
    │   ├── [세션명]_002-004분_subtitle.vtt
    │   └── ...
    ├── ai_response/            # AI 분석 결과 (선택)
    ├── feature/                # 음성 특징 (선택)
    └── meta.json              # 메타정보 (선택)
```

**VTT 파일 형식:**
```vtt
WEBVTT

00:00:01.000 --> 00:00:05.500
[이민정 선생님] 준우야, 오늘 뭐하고 놀까?

00:00:06.000 --> 00:00:08.500
[김준우 아이] 경찰 놀이요!
```

### 출력

```
analysis_results/
└── [세션명]_enhanced_analysis.json     # 분석 데이터

reports/
├── [세션명]_parent_report.txt          # 부모용 레포트
├── [세션명]_teacher_report.txt         # 선생님용 레포트  
├── [세션명]_visit_journal.txt          # 방문일지
└── [세션명]_company_report.txt         # 회사용 레포트
```

---

## 📊 실제 분석 결과 예시

### Case: 김준우 (만4세, 2시간 놀이)

```
============================================================
📈 핵심 지표:
  • 아동 발화 비율: 52.7% (매우 적극적)
  • 아동 발화 수: 3,093회
  • 평균 발화 길이: 3.5 단어
  • 문제해결 발화: 92회 (호기심 높음)
  • 주제 지속도: 3.81 (깊은 몰입)
  • 긍정/부정 비율: 0.57 (다소 부정적)

💯 종합 평가:
  • 아동 주도성: 100.0점 ⭐⭐⭐⭐⭐
  • 언어 표현력: 69.5점 ⭐⭐⭐⭐
  • 인지 참여도: 100.0점 ⭐⭐⭐⭐⭐
  • 정서 안정성: 57.3점 ⭐⭐⭐
  • 집중도: 100.0점 ⭐⭐⭐⭐⭐
  
  ➡️ 종합 점수: 85.4점 (A+ 등급)

💡 강점: 언어 표현, 탐구심, 집중력
⚠️ 개선 영역: 정서 안정성 (긍정적 강화 필요)
============================================================
```

---

## 📝 레포트 비교

### 부모용 vs 선생님용 vs 방문일지 vs 회사용

| 항목 | 부모용 | 선생님용 | 방문일지 | 회사용 |
|------|--------|----------|----------|--------|
| **언어** | 쉬운 표현 | 교육 전문 용어 | 공식 용어 | 데이터 중심 |
| **분량** | 짧고 간결 (1-2페이지) | 중간 (2-3페이지) | 중간 (2페이지) | 상세 (3-5페이지) |
| **톤** | 긍정적, 격려 | 균형적, 전문적 | 객관적, 공식적 | 분석적, 비판적 |
| **데이터** | 최소 | 중간 | 최소 | 전체 |
| **액션** | 가정 활동 제안 | 교육 전략 | 지도 방향 | 품질 개선 |

**예시 문구 비교:**

| 대상 | 동일 내용을 표현하는 방식 |
|------|---------------------------|
| 부모 | "김준우(이)가 대화에 매우 적극적으로 참여했습니다. ⭐⭐⭐" |
| 선생님 | "평가: 매우 적극적으로 언어 표현. 아동 주도적 대화 가능" |
| 방문일지 | "매우 적극적으로 자신의 생각과 느낌을 표현함 (총 3093회 발화)" |
| 회사 | "아동 발화 비율: 52.70% → 아동 주도성 100.0점 (5/5)" |

---

## 🔧 시스템 구조

### 핵심 모듈

```
enhanced_analysis.py          # 📊 분석 엔진
  └─ PlaySessionAnalyzer
      ├─ parse_vtt_files()           # VTT 파싱
      ├─ calculate_metrics()         # 지표 계산
      └─ save_analysis_results()     # JSON 저장

report_generator.py           # 📝 레포트 생성기
  └─ ReportGenerator
      ├─ generate_parent_report()    # 부모용
      ├─ generate_teacher_report()   # 선생님용
      ├─ generate_visit_journal()    # 방문일지
      └─ generate_company_report()   # 회사용

run_full_analysis.py          # 🚀 통합 실행
  ├─ run_full_pipeline()             # 단일 세션
  └─ batch_process_sessions()        # 일괄 처리
```

### 처리 흐름

```
┌─────────────────────┐
│ VTT 파일 읽기        │ → 화자별 발화 추출
│ (parse_vtt_files)   │    (선생님/아이 구분)
└─────────────────────┘
          ↓
┌─────────────────────┐
│ 지표 계산            │ → 8개 핵심 지표 산출
│ (calculate_metrics) │    + 시간대별 분석
└─────────────────────┘
          ↓
┌─────────────────────┐
│ JSON 저장            │ → enhanced_analysis.json
│ (save_results)      │
└─────────────────────┘
          ↓
┌─────────────────────┐
│ 레포트 생성          │ → 4개 문서 자동 생성
│ (ReportGenerator)   │    (parent, teacher, journal, company)
└─────────────────────┘
```

---

## 💡 사용 가이드

### 상세 가이드 문서

- **`ANALYSIS_GUIDE.md`** - 분석 시스템 상세 가이드
- **`SYSTEM_OVERVIEW.md`** - 전체 시스템 개요 및 샘플

### 주요 명령어

```bash
# 1. 단일 세션 분석 (전체 파이프라인)
python3 run_full_analysis.py --session [경로]

# 2. 일괄 처리
python3 run_full_analysis.py --batch

# 3. 분석만 실행 (레포트 제외)
python3 enhanced_analysis.py

# 4. 레포트만 생성 (기존 분석 결과 사용)
python3 report_generator.py
```

---

## 📈 성능 및 품질

### 처리 속도

| 세션 길이 | 발화 수 | 처리 시간 | 비고 |
|-----------|---------|-----------|------|
| 10분 | ~700개 | 2-3초 | 즉시 처리 |
| 2시간 | ~6000개 | 5-10초 | 빠른 처리 |

### 정확도

- **화자 구분:** VTT 기준 100%
- **정서 분석:** 키워드 기반 ~80%
- **주제 추출:** 빈도 기반 ~90%

---

## 🎨 레포트 샘플

### 부모용 레포트 (발췌)

```
╔════════════════════════════════════════════════════════════╗
                놀이 활동 리포트 (학부모용)
╚════════════════════════════════════════════════════════════╝

💬 의사소통 발달
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  • 말하기 참여도: 매우 적극적 ⭐⭐⭐
  • 발화 횟수: 3093회
  • 평가: 김준우(이)가 대화에 매우 적극적으로 참여했습니다.

🏠 가정에서 함께 해보세요
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
• 김준우(이)의 호기심을 격려하고 함께 답을 찾아가세요.
• 긍정적인 표현을 자주 사용하는 모델링을 보여주세요.
```

### 회사용 레포트 (발췌)

```
【교육 품질 지표】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  아동 주도성    [████████████████████████] 100.0점
  언어 표현력    [████████████████        ]  69.5점
  인지 참여도    [████████████████████████] 100.0점
  정서 안정성    [██████████████          ]  57.3점
  집중도         [████████████████████████] 100.0점
  --------------------------------------------------------
  종합 점수      [████████████████████    ]  85.4점
  
종합 등급: A+ (매우 우수)

【개선 권장 사항】
  [중간] 정서 안정성 (57.3점)
     → 긍정적 강화 증대, 정서 인식 활동
```

---

## 📊 배치 분석 (기존 시스템)

기존 `batch_analyze.py`도 계속 사용 가능합니다:

```bash
# 기존 방식 (간단한 통계)
python3 batch_analyze.py

# 생성 파일:
# - analysis_results/*.json
# - reports/comparison_report.txt
# - reports/comparison_report.csv
```

---

## 🚧 향후 개선 계획

### 단기 (1-3개월)

- [ ] PDF 레포트 생성 (전문적 디자인)
- [ ] 시각화 차트 추가 (발화 패턴, 정서 변화)
- [ ] 여러 세션 비교 분석
- [ ] 발달 추이 그래프

### 중기 (3-6개월)

- [ ] 웹 대시보드 (실시간 조회)
- [ ] AI 기반 정서 분석 (BERT)
- [ ] 음성 특징 통합 (피치, 템포)
- [ ] API 서버 구축

### 장기 (6-12개월)

- [ ] 예측 모델 (발달 수준 예측)
- [ ] 다국어 지원
- [ ] 모바일 앱
- [ ] 실시간 분석 (스트리밍)

---

## ⚠️ 제한사항

### 현재 제약

1. **정서 분석**: 키워드 기반 (문맥 미고려)
2. **화자 구분**: VTT 파일 의존
3. **음성 특징**: 미활용 (피치, 템포 등)
4. **토픽 모델링**: 빈도 기반 단순 분석

### 요구사항

- Python 3.7+
- VTT 파일 필수
- 화자 표시: `[이름 선생님]`, `[이름 아이]` 형식

---

## 📞 지원

### 문서

- **사용 가이드**: `ANALYSIS_GUIDE.md`
- **시스템 개요**: `SYSTEM_OVERVIEW.md`
- **빠른 시작**: `QUICK_START.md`

### 문의

- 이슈 등록: [GitHub Issues]
- 이메일: [연락처]
- 기술 지원: [Slack/Discord]

---

## 📜 업데이트 로그

### v2.0.0 (2025-11-14)
- ✨ 4가지 레포트 시스템 (부모/선생님/방문일지/회사)
- ✨ 8개 핵심 지표 분석
- ✨ 품질 점수화 (0-100점)
- ✨ 일괄 처리 기능
- ✨ 시간대별 분석
- ✨ 개선 권장 사항 자동 생성

### v1.0.0 (2025-10-17)
- 🎉 초기 버전
- 기본 분석 기능
- 3가지 레포트 (회사/부모/선생님)

---

**Version**: 2.0.0  
**Last Updated**: 2025-11-14  
**System**: Care Intelligence Analysis Platform  
**License**: Proprietary
